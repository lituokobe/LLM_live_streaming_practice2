[{"bbox": [120, 96, 987, 740], "category": "Text", "text": "```java\n//设置最大重试次数，默认3\nwithMaxRetries(5)\n.build(),\nnew JdbcConnectionOptions.JdbcConnectionOptionsBuilder()\n    .withUrl(\"jdbc:mysql://node2:3306/mydb?useSSL=false\")\n    .withDriverName(\"com.mysql.jdbc Drivers\")\n    .withUsername(\"root\")\n    .withPassword(\"123456\")\n    .build()\n)\n\n//数据写出到MySQL\nds.addSink(jdbcSink)\nenv.execute()\n```"}, {"bbox": [108, 784, 1587, 936], "category": "Text", "text": "**注意**：在编写Scala JdbcSink代码时，JdbcSink.sink第二个参数不能使用Scala匿名函数写法，否则会报错：“ The implementation of the RichOutputFormat is not serializable. The object probably contains or references non serializable fields.”"}, {"bbox": [110, 968, 765, 1020], "category": "Section-header", "text": "### 3) 向Socket中输入以下数据查询mysql结果"}, {"bbox": [120, 1062, 487, 1283], "category": "Text", "text": "```\n001,186,187,busy,1000,10\n002,187,186,fail,2000,20\n003,186,188,busy,3000,30\n004,188,186,busy,4000,40\n005,188,187,busy,5000,50\n```"}, {"bbox": [110, 1341, 599, 1401], "category": "Section-header", "text": "## 6.6.2.2 exactly-once语义"}, {"bbox": [108, 1431, 1574, 1579], "category": "Text", "text": "从Flink1.13版本开始，Flink JDBC Sink支持exactly-once写出语义，该实现依赖于数据库支持支持XA标准规范，目前大多数数据库都支持XA，即如果数据库支持XA标准规范，就支持Flink JDBC Sink的Exactly-once的写出语义。"}, {"bbox": [108, 1611, 1557, 1761], "category": "Text", "text": "备注：XA标准是由 X/Open 组织提出的分布式事务规范。目前，Oracle、Informix、DB2和MySQL等各大数据库厂家都提供对XA标准的支持。XA标准规范采用两阶段提交方式来管理分布式事务。"}, {"bbox": [110, 1796, 1245, 1847], "category": "Text", "text": "使用Flink JdbcSink Exactly-once语义将数据写出到外部存储库时需要注意："}, {"bbox": [132, 1878, 1587, 2087], "category": "List-item", "text": "* Flink写出数据必须开启checkpoint否则不能正常将数据写出,checkpoint周期决定了写出数据的延迟大小。\n* JDBC XA接收器要求maxRetries等于0，否则可能导致重复，代码中JdbcExecutionOptions需要设置maxRetries为0。"}]