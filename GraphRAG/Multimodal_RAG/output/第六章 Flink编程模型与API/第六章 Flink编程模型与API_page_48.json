[{"bbox": [194, 102, 1537, 480], "category": "Text", "text": "```java\n        * 003,186,188,busy,3000,30\n        * 004,188,186,busy,4000,40\n        * 005,188,187,busy,5000,50\n    */\nSingleOutputStreamOperator<StationLog> ds = env.socketTextStream(\"node5\", 9999)\n    .map(one -> {\n        String[] arr = one.split(\",\");\n        return new StationLog(arr[0], arr[1], arr[2], arr[3], Long valueOf(arr[4]), Long.of\n        ).of(arr[5]);\n    });\n```"}, {"bbox": [120, 526, 1602, 2098], "category": "Text", "text": "```java\n//设置JdbcSink ExactlyOnce 对象\nSinkFunction<StationLog> jdbcExactlyOnceSink = JdbcSink.exactlyOnceSink(\n    \"insert into station_log sid,call_out,call_in,call_type,call_time,duration\n    ) values(?,?,?,?,?,?)\",\n    ( href, stationLog ) -> {\n        href.setString(1, stationLog.getSid());\n        href.setString(2, stationLog.getCallOut());\n        href.setString(3, stationLog.getCallIn());\n        href.setString(4, stationLog.getCallType());\n        href.setLong(5, stationLog.getCallTime());\n        href.setLong(6, stationLoggetDuration());\n    },\n    JdbcExecutionOptions builder()\n        //批次提交大小,默认500\n        .withBatchSize(1000)\n        //批次提交间隔间隔时间,默认0,即批次大小满足后提交\n        .withBatchIntervalMs(1000)\n        //最大重试次数,默认3,JDBC XA接收器要求maxRetries等于0,否则可能导致重复。\n        .withMaxRetries(0)\n        .build(),\n    JdbcExactlyOnceOptions builder()\n        //只允许每个连接有一个XA事务\n        .withTransactionPerConnection(true)\n        .build(),\n    // //创建XA parcer\n    // new SerializableSupplier<XADatasource>() {\n    //     @Override\n    //     public XADatasource get() {\n    //         MysqlXADataSource xaDataSource = new com.mysql.jdbc.jdbc2Paym\n    //                 xaDataSource.setUrl(\"jdbc:mysql://node2:3306/mydb?useS\n    //                 xaDataSource.setUser(\"root\");\n    //                 xaDataSource抛密码(\"123456\");\n    //                 return xaDataSource;\n    //             }\n    //         }\n    //     }\n    //创建XA parcer对象也可以使用lambda表达式\n    () -> {\n        MysqlXADataSource xaDataSource = new MysqlXADataSource();\n```"}]