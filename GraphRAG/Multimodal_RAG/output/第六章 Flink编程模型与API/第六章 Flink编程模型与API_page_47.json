[{"bbox": [109, 124, 827, 169], "category": "Text", "text": "在编写Java和Scala代码之前需要导入项目依赖："}, {"bbox": [125, 217, 857, 730], "category": "Text", "text": "```xml\n <!-- Flink JdbcSink依赖jar包 -->\n<dependency>\n  <groupId>org.apache flink</groupId>\n  <artifactId>flink-connector-jdbc</ artifactId>\n  <version> ${flink-connector-jdbc.version}</version>\n</dependency>\n <!-- MySQL驱动依赖jar包 -->\n<dependency>\n  <groupId>mysql</groupId>\n  < artifactId>mysql-connector-java</ artifactId>\n  <version> ${mysql.version}</version>\n</dependency>\n```"}, {"bbox": [109, 777, 1001, 825], "category": "Text", "text": "案例:Flink读取Socket中通话数据通过转换写入到MySQL中。"}, {"bbox": [109, 860, 542, 909], "category": "Section-header", "text": "## 1) 在MySQL中需要数据库表"}, {"bbox": [125, 957, 704, 1127], "category": "Text", "text": "```sql\n#登录mysql创建数据库及表\n[root@node2 ~]# mysql -u root -p123456\nmysql> create database mydb;\nmysql> use mydb;\n```"}, {"bbox": [125, 1169, 681, 1549], "category": "Text", "text": "```sql\n#建表语句如下\nCREATE TABLE `station_log` (\n  `sid` varchar(255) DEFAULT NULL,\n  `call_out` varchar(255) DEFAULT NULL,\n  `call_in` varchar(255) DEFAULT NULL,\n  `call_type` varchar(255) DEFAULT NULL,\n  `call_time` bigint(20) DEFAULT NULL,\n  `duration` bigint(20) DEFAULT NULL\n);\n```"}, {"bbox": [109, 1601, 294, 1646], "category": "Section-header", "text": "## 2) 编写代码"}, {"bbox": [133, 1685, 389, 1729], "category": "Section-header", "text": "### Java代码实现"}, {"bbox": [125, 1780, 1408, 2074], "category": "Text", "text": "```java\nStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n//必须设置checkpoint,否则数据不能正常写出到mysql\nenv.enableCheckpointing(5000);\n/**\n * socket 中输入数据如下:\n * 001,186,187,busy,1000,10\n * 002,187,186,fail,2000,20\n```"}]