[{"bbox": [123, 100, 1277, 821], "category": "Text", "text": "```java\nint indexOfThisSubtask = getRuntimeContext().getIndexOfThisSubtask();\nif (1 == getRuntimeContext().getIndexOfThisSubtask()) {\n    ctx.collect(elem);\n}\n}\n}\n\n@Override\npublic void cancel() {\n\n}\n});\n\n//比较rescale和rebalance的区别\nds.rescale().print(\"rescale\").setParallelism(3);\n// ds.rebalance().print(\"rebalance\").setParallelism(4);\nenv.execute();\n```"}, {"bbox": [135, 874, 401, 916], "category": "Section-header", "text": "## • Scala代码实现"}, {"bbox": [123, 969, 1023, 1052], "category": "Text", "text": "```scala\nval env = StreamExecutionEnvironment.getExecutionEnvironment\nenv.setParallelism(2)\n```"}, {"bbox": [123, 1097, 589, 1180], "category": "Text", "text": "//导入隐式转换\nimport org.apache flink api scala._"}, {"bbox": [123, 1226, 1407, 2071], "category": "Text", "text": "```scala\nval ds: DataStream[Object] = env.addSource[Object](new RichParallelSourceFunction[Object] {\n  var isRunning = true\n\n  override def run(ctx: SourceFunction SourceContext[Object]): Unit = {\n    val list1 = List[IString](\"a\", \"b\", \"c\", \"d\", \"e\", \"f\")\n    val list2 = List[Integer](1, 2, 3, 4, 5, 6)\n    list1.forEach(one => {\n      if (0 == getRuntimeContext.getIndexOfThisSubtask) {\n        ctx.collect(one)\n      }\n    })\n    list2.forEach(one => {\n      if (1 == getRuntimeContext.getIndexOfThisSubtask) {\n        ctx.collect(one)\n      }\n    })\n  }\n\n  override def cancel(): Unit = {\n```"}]