[{"bbox": [122, 102, 1427, 356], "category": "Text", "text": "```java\nJdbcSink.sink(\n    sqlDmlStatement, // 必须指定, SQL语句\n    jdbcStatementBuilder, // 必须指定, 给SQL语句设置参数\n    jdbca執行Option, // 可选, 指定写出参数, 如: 提交周期、提交批次大小、重试时间, 建议指定。\n    jdbcconnectionOptions // 必须指定, 数据库连接参数\n);\n```"}, {"bbox": [110, 402, 1578, 551], "category": "Text", "text": "在编写Scala代码时, `JdbcStatementBuilder`参数必须通过`new JdbcStatementBuilder`方式创建,\n不能使用Scala匿名函数Lambda方式编写, 否则代码报序列化错误不能正常运行, 该错误与Scala编译器版本有关。"}, {"bbox": [110, 588, 826, 635], "category": "Text", "text": "在编写Java和Scala代码之前需要导入项目依赖："}, {"bbox": [128, 685, 856, 1194], "category": "Text", "text": "```xml\n <!-- Flink JdbcSink依赖jar包 -->\n<dependency>\n    <groupId>org.apache flink</groupId>\n    <artifactId>flink-connector-jdbc</ artifactId>\n    <version> ${flink-connector-jdbc.version}</version>\n</dependency>\n <!-- MySQL驱动依赖jar包 -->\n<dependency>\n    <groupId>mysql</groupId>\n    < artifactId>mysql-connector-java</ artifactId>\n    <version> ${mysql.version}</version>\n</dependency>\n```"}, {"bbox": [110, 1243, 1001, 1291], "category": "Text", "text": "案例:Flink读取Socket中通话数据通过转换写入到MySQL中。"}, {"bbox": [110, 1326, 541, 1375], "category": "Section-header", "text": "## 1) 在MySQL中需要数据库表"}, {"bbox": [124, 1425, 703, 1593], "category": "Text", "text": "```sql\n#登录mysql创建数据库及表\n[root@node2 ~]# mysql -u root -p123456\nmysql> create database mydb;\nmysql> use mydb;\n```"}, {"bbox": [124, 1636, 682, 2016], "category": "Text", "text": "```sql\n#建表语句如下\nCREATE TABLE `station_log` (\n  `sid` varchar(255) DEFAULT NULL,\n  `call_out` varchar(255) DEFAULT NULL,\n  `call_in` varchar(255) DEFAULT NULL,\n  `call_type` varchar(255) DEFAULT NULL,\n  `call_time` bigint(20) DEFAULT NULL,\n  `duration` bigint(20) DEFAULT NULL\n);\n```"}]