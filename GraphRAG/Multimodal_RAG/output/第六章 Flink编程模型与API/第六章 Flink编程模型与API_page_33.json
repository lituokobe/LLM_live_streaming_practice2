[{"bbox": [123, 99, 1487, 1250], "category": "Text", "text": "```groovy\ndef env = env.socketTextStream(\"node5\", 9999);\nds.map(new MyMapFunction()).print();\n\nenv.execute();\n}\n\nprivate static class MyMapFunction implements MapFunction<String, String> {\n    @Override\n    public String map(String value) throws Exception {\n        //value格式: 001,186,187,busy,1000,10\n        String[] split = value.split(\",\");\n        //获取通话时间,并转换成yyyy-MM-dd HH:mm:ss格式\n       SimpleirkFormat sdf = new SimpleirkFormat(\"yyyy-MM-dd HH:mm:ss\");\n        String beginTime = sdf.format(Long\n```"}, {"bbox": [134, 1298, 334, 1340], "category": "Title", "text": "## Scala代码"}, {"bbox": [126, 1392, 1060, 2073], "category": "Text", "text": "```groovy\nobject CommonFunctionTest {\n    def main(args: Array String): Unit = {\n        val env = StreamExecutionEnvironment.getExecutionEnvironment\n\n        //导入隐式转换\n        import org.apache flink api Play\n\n        /**\n         * Socket中的数据格式如下:\n         * 001,186,187,busy,1000,10\n         * 002,187,186,fail,2000,20\n         * 003,186,188,busy,3000,30\n         * 004,188,186,busy,4000,40\n         * 005,188,187,busy,5000,50\n         */\n        val ds: DataStream [String] = env.socketTextStream(\"node5\", 9999)\n```"}]