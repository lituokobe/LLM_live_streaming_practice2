[{"bbox": [111, 103, 293, 147], "category": "Title", "text": "## 2) 编写代码"}, {"bbox": [135, 187, 388, 229], "category": "Text", "text": "* **(Java代码实现)**"}, {"bbox": [123, 280, 1537, 2067], "category": "Text", "text": "```java\nStreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n\n/**\n * socket 中输入数据如下:\n * 001,186,187,busy,1000,10\n * 002,187,186,fail,2000,20\n * 003,186,188,busy,3000,30\n * 004,188,186,busy,4000,40\n * 005,188,187,busy,5000,50\n */\nSingleOutputStreamOperator<StationLog> ds = env.socketTextStream(\"node5\", 9999)\n    .map(one -> {\n        String[] arr = one.split(\",\");\n        return new StationLog(arr[0], arr[1], arr[2], arr[3], Long\n        return new StationLog(arr[0], arr[1], arr[2], arr[3], Long\n    });\n\n/**\n * mysql中创建的station_log 表结构如下;\n *\n * CREATE TABLE `station_log` (\n *   `sid` varchar(255) DEFAULT NULL,\n *   `call_out` varchar(255) DEFAULT NULL,\n *   `call_in` varchar(255) DEFAULT NULL,\n *   `call_type` varchar(255) DEFAULT NULL,\n *   `call_time` bigint(20) DEFAULT NULL,\n *   `duration` bigint(20) DEFAULT NULL\n * );\n */\n//准备JDBC Sink对象\n// SinkFunction<StationLog> jdbcSink = JdbcSink.sink(\n//     \"insert into station_log\n//     new JdbcStatementBuilder<StationLog>() {\n//         @Override\n//         public void accept(aris, StationLog stationLog) throws Exception {\n//             pst.setString(1, stationLog.getSid());\n//             pst.setString(2, stationLog.getCallOut());\n//             pst.setString(3, stationLog.getCallIn());\n//             pst.setString(4, stationLog.getCallType());\n//             pst.setLong(5, stationLog.getCallTime());\n//             pst.setLong(6, stationLoggetDuration());\n//         }\n```"}]