[{"bbox": [120, 97, 1159, 699], "category": "Text", "text": "```groovy\noverride def getCommandDescription: RedisCommandDescription = {\n    new RedisCommandDescription(RedisCommand.HSET, \"fink-scala-redis\")\n}\n\n//指定写入Redis的Key\noverride def getKeyFromData(t: (String, Int)): String = t._1\n\n//指定写入Redis的Value\noverride def值ValueFromData(t: (String, Int)): String = t._2.toString\n})\n\n//将结果写入Redis\nresult.addSink CompanySink)\nenv.execute(\"CompanySinkTest\")\n```"}, {"bbox": [107, 743, 1567, 842], "category": "Text", "text": "注意：以上代码执行过程中连接Reids报错：Could not get a resource from the pool，可能是没有配置Redis允许外部节点远程连接，配置参考Redis搭建部分。"}, {"bbox": [112, 878, 948, 926], "category": "Text", "text": "以上代码执行后可以向Socket中输入如下数据进行测试："}, {"bbox": [124, 973, 313, 1145], "category": "Text", "text": "```\nhello,flink\nhello,spark\nhello,hadoop\nhello,java\n```"}, {"bbox": [112, 1193, 562, 1240], "category": "Text", "text": "查询Redis中的数据存储结果："}, {"bbox": [124, 1289, 708, 1969], "category": "Text", "text": "```\n[root@node4 ~]# redis-cli\n127.0.0.1:6379> select 1\nOK\n127.0.0.1:6379[1]> keys *\n1) \"flink-scala-redis\"\n127.0.0.1:6379[1]> hgetall flink-scala-redis\n1) \"hello\"\n2) \"4\"\n3) \"flink\"\n4) \"1\"\n5) \"hadoop\"\n6) \"1\"\n7) \"spark\"\n8) \"1\"\n9) \"java\"\n10) \"1\"\n```"}, {"bbox": [112, 2032, 557, 2092], "category": "Title", "text": "### 6.6.5 自定义Sink输出"}]